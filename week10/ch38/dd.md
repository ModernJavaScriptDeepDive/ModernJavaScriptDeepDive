# 브라우저의 렌더링 과정

## 브라우저가 렌더링을 하기 까지

- 서버로부터 렌더링에 필요한 요소들, HTML/CSS/JS/Image/Font 등을 요청하고, 응답 받는다. 

- 브라우저의 렌더링 엔진이 응답 받은 HTML을 파싱해서 DOM을, CSS를 파싱해서 CSSOM을 생성하고, 이 둘을 결합해서 렌더 트리를 생성한다

- 브라우저의 자바스크립트 엔진이 응답 받은 JS를 파싱해서 AST(Abstract Syntax Tree)를 생성하고, 바이트코드로 변환/실행한다. 이때 JS는 DOM API로 DOM/CSSOM을 변경가능하다

- 렌더 트리를 기반으로 HTML 요소의 레이아웃을 계산하고, 페인팅한다


## HTTP 1.1 / 2.0

- 1.1은 하나의 요청/응답만 처리하기에 리소스 동시 전송이 불가능하다

- 2.0은 커넥션당 여러 요청/응답이 가능해서, 약 50% 정도 빠르다


## HTML 파싱

- 브라우저가 서버로부터 응답받은 HTML 문서는 바이트 형태이고, meta 태그의 charset의 인코딩 방식(UTF-8)을 기준으로 문자열로 변환된다. 그 이후에 파싱이 진행되고, 토큰으로 분해된다. 

- 토큰은 객체로 변환되며 노드를 생성한다. 이 노드는 DOM을 구성하는 기본 요소이다.


## 레이아웃 계산 / 페인팅이 일어나는 경우

- JS에 의한 노드 추가/삭제
- 브라우저 창 리사이징에 의한 뷰포트 크기 변경
- HTML 요소의 레이아웃을 변경시키는 CSS 속성 변경 
   - width/height
   - margin/padding
   - border
   - display
   - position
   - top/bottom/left/right 등..

## script 태그의 async / defer 속성

### async

- HTML 파싱 / 외부 자바스크립트 로드가 비동기적으로 실행
- 단 외부 자바스크립트 파일이 로드되면 바로 파싱/실행이 시작되며, 이 순간 HTML 파싱이 중단 된다
- 여러 script 태그가 모두 async 속성이 있다면 먼저 로드 되는 순서대로 실행되기 때문에 순서를 보장할 수 없다

### defer 

- async처럼 HTML 파싱과 외부 자바스크립트 로드를 비동기적으로 실행시킨다
- 다만 자바스크립트 로드가 완료 되더라도 DOM 생성이 완료된 직후에 실행된다. 

