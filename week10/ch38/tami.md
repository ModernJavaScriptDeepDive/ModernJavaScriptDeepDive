# 📒 38- 브라우저 렌더링 과정

대부분의 프로그래밍 언어 = **OS, 가상머신 위에서 실행**
JS  = **브라우저에서 CSS,HTML 과 함께 실행**

### 파싱
텍스트문자열을 토큰으로 분해하려 파스트리구조를 생성하는  과정

## 브라우저 렌더링과정
1. 브라우저는 서버에게 리소스 요청
2. 브라우저의 렌더링 엔진은 응답을 파싱하여 DOM,CSSOM을 생성하고 이걸 결합해 렌더링 트리 생성
3. 브라우저의 JS엔진은 JS파싱하고 바이트코드로 변환하여 실행
4. 렌더트리를 기반으로 레이아웃 계산 후 페인팅

## 요청과 응답
### 주소창
서버에 요청을 전송하기 위해 주소창 제공

DNS : URL 의 호스트이름 -> IP 주소로 변환

- 일반적인 서버는  루트요청에 index.html 을 응답하도록 기본설정
- 정적파일 요청시엔 URI 호스트 뒤 path  기술
- 브라우저 렌더링 엔진은 파싱 도중 외부리소스태그(`link`,`img`,`script`)를 만나면 파싱 일시중단하고 해당 파일 서버에 요청

#### HTML 파싱
HTML을 시작적인  픽셀로 렌더링하기 위해 브라우저가 이해할 수 있는 자료구조로 변환하여 메모리에 저장하는 것

HTML -> **(파싱)** -> DOM
HTML -> **바이트 -> 문자 -> 토큰 -> 노드** -> DOM
#### CSS 파싱
HTML  과 동일한 과정 

#### 렌더트리 생성
렌더링을 위한 트리구조의 자료구조
DOM + CSSOM => 렌더트리 
- 비표시 노드 미포함( display: none)

## JS 파싱과 실행
`렌더링엔진`HTML 파싱 ->`JS엔진`JS파싱 시 ->`렌더링엔진`HTML 파싱

JS -> AST(추상적 구문 트리) -> 중간코드(`itermediate`)인 바이트 코드


#### 리플로우 리페인트
렌더트리를 기반으로 레이아웃을 계산하고 페인팅 하는 과정

리플로우 : 레이아웃 다시 계산 (노드 추가삭제, 요소와 크기, 윈도우 리사이징 등 레이아웃에 영향이 있을 때)


### JS파싱에 의한 HTML파싱 중단
##### ⭐️ 브라우저는 동기적으로 JS를 파싱하고 실행한다.

1) body 밑에 <script> 두기
따라서 script 태그를 body 밑에 둠으로써 DOM 생성이 완료된 후 JS가 실행되기 때문에 DOM 조작 에러 방지와  페이지 로딩시간 단축의 장점이 있다.

2) aysnc/ defer
HTML 파싱과 외부 JS가 비동기적으로 동시 진행

async : HTML파싱 & JS 파싱 동시 진행 , JS로드 직후 실행
defer : HTML파싱 & JS 파싱 동시 진행 , DOM 생성 직후 실행
